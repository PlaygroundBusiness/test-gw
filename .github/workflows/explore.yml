name: GitHub Actions Demo

on:
  push:
    branches: [master]
    tags:
      - '**'
  pull_request:
    branches: [master]

jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - run: echo "🎉 The job was automatically triggered by a ${{ github.event_name }} event."
      - run: echo "🐧 This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - run: echo "🔎 The name of your branch is ${{ github.ref }}, shorter ${{ github.ref_name }} and your repository is ${{ github.repository }}."
      - run: echo "🔎 The base ref is ${{ github.base_ref }} and sha is ${{ github.sha }}"

  ci:
    if: ${{ !startsWith(github.ref, 'refs/tags/') }}
    runs-on: ubuntu-latest
    steps:
      - run: echo "🎉 From pull request or branches"

  deploy-dev:
    if: github.event_name == 'pull_request'
    runs-on: ubuntu-latest
    steps:
      - run: echo "🎉 From pull request."

  deploy-staging:
    # On master and beta branches
    if: ${{ github.event_name == 'push' && ! startsWith(github.ref, 'refs/tags/') }}
    runs-on: ubuntu-latest
    steps:
      - run: echo "🎉 From master branch"

  tag:
    if: startsWith(github.ref, 'refs/tags/')
    runs-on: ubuntu-latest
    steps:
      - run: echo "🎉 tag"

  deploy-production:
    needs: [tag]
    # On creating a tag
    if: startsWith(github.ref, 'refs/tags/')
    runs-on: ubuntu-latest
    steps:
      - run: echo "🎉 deploy production after tag"

